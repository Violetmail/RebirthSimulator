# RebirthSimulator

![java](https://img.shields.io/badge/language-java-blue)
![API](https://img.shields.io/badge/API-29-blue)




这是一个转生模拟器

通过抽卡获得具备相关属性的角色以此来执行“转生”的文字游戏。
| :exclamation:仅作AS学习使用，不进行传播<br>文本内容部分引用网络，侵删<br>Only for personal，never spread it.The context is partially referenced by the Internet.<br>If tort I will delete this. |
| ------------------------------------------------------------------------------------------------------------------------- |

主要使用Android Studio进行开发，版本号：11.0.12
## 前言
### 项目背景
即使现代多媒体技术发达完善，但是文字的表达在各行各业还是逻辑的基础，文字游戏在如今也没有见得被淘汰，而是融入在了方方面面之中，都是在此之上添砖加瓦。设计一个有趣的文字游戏还是很受欢迎的，之前热门过一段时间的“人生重开模拟器“正是如此，用搞怪和有趣的方式呈现一种新的”投胎“方式。本app也是基于此进行的优化改良和自我学习。
### 项目简介
诚然，灵感来源于 “人生重来模拟器”，但本app融合了抽卡模拟器和前者。去除了繁琐且不见成效得天赋加点，通过抽卡获得自带固有属性得卡片人物，根据固有属性，同时“转生“过程中增加分支选项的功能，在“转生“过程中呈现更加丰富且有趣的内容。
### 项目可行性
完全基于Andriod Studio开发，同时项目搭载在github仓库中，小组协同操作。
本app功能实现并不复杂，但是对数据逻辑要求较高，比如构思货币和卡片的获取，卡片相关属性的平衡，以及各类数据的关联和权重思考。如何设计令人满意且通情达理的文本呈现是转生功能的一大要点。总体来说，是个具有实际操作可能性和实现可能性的app。
### 项目目标
可以完整实现抽卡模拟器的功能，同时基于所获得的卡片能在“转生“界面执行丰富的转生内容，并获得奖励和人生总结，获取全新的货币，全新的人物，产生简单的游戏效果。
## 项目说明
### 框架构成
通过使用三个fragment，实现具有底部三个调转栏的功能，分别为图鉴，抽卡和转生。由上角添加菜单栏添加设置和退出功能。设置中配有清除数据按钮和注销按钮。关于按钮中添加webview，可以查看当前app版本以及访问项目所在的GitHub地址。在抽卡界面点击头像中可以查看简要的账号信息。用户登陆不需要密码，只需要用户名即可，用来保存获得的卡片和转生的次数。
### 卡片和货币
卡片品质分为[Max][S][A][B][C]五种，每种品质的卡对应相应颜色，并且不同rank属性有一定差异。图鉴界面会展示所有可以抽到的卡片，但均为灰色，若在抽卡界面抽到后，图鉴界面相应的将卡片颜色点亮。同时图鉴界面可以通过点击查看卡片的相关属性。
角色也支持通过游戏内货币（转生可以获得）购买。app内设有三种货币，分别用于抽卡消耗，卡片购买以及水晶充值。
货币的游戏的一个基本属性，也为后期游戏加入更多元素留下基础。暂定使用“水晶“进行抽卡，“转生碎片”用于购买，“水晶券”用来增加水晶。
### 转生
转生界面通过选择拥有的卡片执行转生，在转生界面点击按钮将会出现文本描述相关的角色概况，从角色出生到角色死亡。在转生内容的显示过程中会分化出选择支，通过选择不同的选项，可以改变人物的结果。在每次游戏之后（死亡）可以点击“人生总结“按钮，查看简要的记录的转生结果，同时每次转生后都可以选择一次天赋，可以不断迭代改变卡片角色的部分属性。


## 功能列表与计划（完成度：100%）
- [x] 数据库
- [x] 弹窗功能
- [x] 抽卡
  - [x] 单抽
  - [x] 可控改变概率
  - [x] 自定义部分货币数
  - [x] 显示保底次数
  - [x] 链接到图鉴
  - [x] 链接到转生
- [x] 图鉴
  - [x] 显示全部卡片
  - [x] 显示拥有的卡片
  - [x] 区分卡片是否拥有
  - [x] 根据rank显示相应颜色
  - [x] 购买卡片
- [x] 转生
  - [x] 显示文本
  - [x] 关联卡片
  - [x] 选择分支
  - [x] 人生总结
  - [x] 天赋继承
- [x] 菜单
  - [x] 登陆
  - [x] 设置
  - [x] 关于
  - [x] 显示github网页
- [x] 设置
  - [x] 重置数据
  - [x] 删除账号
- [x] 用户界面
  - [x] 注销
  - [x] 登陆
  - [x] 注册

## 数据库构成
通过使用room，构造数据库，定义表和Dao接口并在activity中实例化他们，进而对数据库增删查改。
### 表构成
首先创建五个表：用户表，卡牌表，用户卡牌表，转生内容表，以及天赋表。后期根据项目完成度考虑是否创建卡牌专用的卡牌转生内容表。

在用户表中存放，id，用户名（str），用户水晶数量(int)，用户货币数量(int)（有三种），用户抽卡次数(int).

在卡牌表中存放，id，卡牌名称，卡牌属性（为四个属性：外貌，体质，家境，智力）

用户卡牌表中存放用户拥有的卡牌信息，包括id，用户名和卡牌名称。

转生内容表中包括转生的全部文本，属性有id，年龄，转生内容，分支一内容，分支二内容，以及对相关属性的需求（同上四种属性）

天赋表中包括天赋的id，内容，和修改的属性，以及修改的数值，便于直接进行卡片属性操作。
### 逻辑
为每个表创建各自的Dao文件，在其中定义方法，在activity中实例化各个Dao，调用其中的方法，实现对数据库的增删查改。

用户表连接到登陆注销功能界面，通过用户名是否登陆的属性，判断当前登陆用户的用户名，进而将相关信息更新为该用户的属性（水晶，碎片等），同时登陆界面也转化为个人信息界面，显示用户名。当然，此界面也包括了注销功能。
未登陆或者注销，用户将自动变为“guest”的系统内置用户。
用户Dao中写了，根据用户名获得用户对象的函数，以及为了方便修改用户数据，定义了三种货币的直接修改函数（使用@update）

卡牌表使用定义完成后被抽卡界面调用，读取到的卡牌信息存放到用户卡牌表中，同时更新图鉴，将用户卡牌表中卡牌在图鉴中的背景色显示为亮色。在用户卡片表中，定义了需要用户名和卡片名共同查找的函数，返回单一卡片对象。

转生内容表根据年龄属性排列，每次点击会随机跳出顺序年龄的文本，随机概率由卡牌的属性值考虑。同时部分文本带有分支选项，该文本会使得转生界面中生成两个按钮，触发更多有趣的内容。转生表的Dao中除了定义相关的增删查改函数以外，还定义了约束查找，返回对对卡片属性有一定要求的转生内容对象，比如要求体质大于50，智力大于60才可触发的内容，通过输入当前角色的属性作文参数，返回相应的结果。

### 数据插入
由于三个面板创建在mainactivity中，数据如卡片数据和转生内容数据，在安装时就完全定义，当启动时调用mainactivity时进行数据库判空，空则插入预设数据。主要进行三类数据的插入，卡片的内容、属性；转生的文本、分支、属性需求；天赋的内容、数值。

## 界面功能与介绍

### 图鉴
图鉴主要由一个recycleview和两个按钮构成。通过定义适配器，按钮显示不同的recycleview内容（全部卡片和已拥有卡片）。左上角显示当前的碎片数量，从用户数据库中读取，为了方便用户进行卡片购买。
在图鉴界面主要进行卡片信息的展示，相关属性，是否拥有？以及对未拥有的卡片进行购买。

### 抽卡
抽卡功能主要集中在概率的分配，定义抽卡函数，通过调用随机数函数实现一次抽卡。同时抽卡后将改变各类属性，比如货币数量，保底次数等，均和数据库产生连接，并每次抽卡后执行界面刷新。在水晶的显示框旁边有使用水晶券的按钮，每次使用会弹出对话框确认，使用后会立刻改变相关数据以及界面刷新。
同时为了降低抽卡的难度，也增添了提高抽卡概率的switch开关按钮，通过打开开关，可以获得更高的抽卡概率。（但是图鉴中有的卡片是无法通过抽卡获得的，只能通过碎片购买）
在抽卡界面中有一个类似头像的按钮可以链接到用户登陆处。
### 用户界面
在用户界面可以进行账号的登陆，注册和登出，未拥有账号的操作者，默认账号为guest，自带大量货币和一定的水晶券方便测试。
用户登陆只需要用户即可，数据全部存放在数据库的user表中
### 转生
转生界面有三个过程。一，先进行角色选择，二进行转生文本的显示，三，执行人生总结。
为了一二两个步骤，为转生界面的recyclview创建了两个适配器，分别用于执行一和二的过程。

在过程一中，首先选择转生对象，从已经拥有的卡片中调用，选中后按钮变色提醒，并弹出对话框确认。确认完毕则进入过程二，即改变适配器为适配器二。

过程二中，首先显示上一步选择的人物的背景，底部有继续按钮，点击进行持续转生。
其中涉及对recycview每个item显示不一定完全相同的问题，通过使得按钮可见度为“GONE”来使得排版统一。在读取的转生内容中包含有分支选择的时候改变按钮可见度。
在文本出现死亡后，继续按钮消失，出现“重新开始”和“人生总结”的按钮，通过点击“人生总结”按钮进入过程三。

为了便于管理，将过程三设置为独立的activity，其中顶部根据享年显示一句概括性语句。在下面分别展示死亡时候角色的外貌，智力，体质，家境的数值，同时还显示根据属性套用公式计算过的“快乐”和“总评”数值。
在人生总结界面中可以选择天赋，天赋的继承效果理解为对数据库中卡片属性的永久修改，点击其中一个天赋另一个将会消失，可以不选择天赋直接重开。
### 菜单与设置
右上角的菜单栏主要分配三个工作，对账号的处理，对数据的清除和对app信息的展示。
为此菜单中添加了关于按钮和设置按钮，关于界面中通过webview链接到了项目的github，方便的展示内容。设置界面中可以执行清除当前账号的数据以及对账号的删除，在执行后会给予toast的文本提示。
同时也配有退出程序的功能。
## 代码模块展示与说明
在这个部分，主要展示功能和代码的对应。程序全程在android studio上进行。
主要的文件结构如下：


在AppData文件夹中存放数据库文件，分别对应相应的表。


ui文件夹中存放主要的三个面板的布局和activity的逻辑


项目中其他的内容如对数据库定义的各类DAO接口，菜单，设置，用户的activity均裸放在文件夹中



## 总结
loading...
